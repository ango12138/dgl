import dgl
from module import LaplacianPE
transform1 = LaplacianPE(k=3)
transform2 = LaplacianPE(k=5, padding=True)
transform3 = LaplacianPE(k=5, feat_name='eigvec', eigval_name='eigval', padding=True, return_eigval=True)
g = dgl.rand_graph(5, 10)
g1 = transform1(g)
print(g1.ndata['PE'])
# tensor([[-0.0697, -0.0697,  0.0131],
#         [ 0.0953,  0.0953, -0.3502],
#         [ 0.3501,  0.3501,  0.5598],
#         [ 0.3929,  0.3929, -0.2883],
#         [-0.5751, -0.5751, -0.2018]])
g2 = transform2(g)
print(g2.ndata['PE'])
# tensor([[-0.0697,  0.0697,  0.0131,  0.0131,  0.0000],
#         [ 0.0953, -0.0953, -0.3502, -0.3502,  0.0000],
#         [ 0.3501, -0.3501,  0.5598,  0.5598,  0.0000],
#         [ 0.3929, -0.3929, -0.2883, -0.2883,  0.0000],
#         [-0.5751,  0.5751, -0.2018, -0.2018,  0.0000]])
g3 = transform3(g)
print(g3.ndata['eigval'])
# tensor([[0.9158, 0.9158, 1.4175, 1.4175,    nan],
#         [0.9158, 0.9158, 1.4175, 1.4175,    nan],
#         [0.9158, 0.9158, 1.4175, 1.4175,    nan],
#         [0.9158, 0.9158, 1.4175, 1.4175,    nan],
#         [0.9158, 0.9158, 1.4175, 1.4175,    nan]])
print(g3.ndata['eigvec'])
# tensor([[ 0.0697, -0.0697,  0.0131, -0.0131,  0.0000],
#         [-0.0953,  0.0953, -0.3502,  0.3502,  0.0000],
#         [-0.3501,  0.3501,  0.5598, -0.5598,  0.0000],
#         [-0.3929,  0.3929, -0.2883,  0.2883,  0.0000],
#         [ 0.5751, -0.5751, -0.2018,  0.2018,  0.0000]])